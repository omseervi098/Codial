$(document).ready((function(){let e=function(e,a,t){return $(`\n  <div id="post-${e._id}" class="post">\n  <div class="ithpost">\n    <div class="card">\n      \x3c!-- Card header START --\x3e\n      <div class="card-header border-0 py-2 px-2">\n        <div class="d-flex align-items-center justify-content-between">\n          <div class="d-flex align-items-center">\n            \x3c!-- Avatar --\x3e\n            <div class="avatar avatar-story me-2">\n              <a href="#!">\n                <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="avatar" />\n              </a>\n            </div>\n            \x3c!-- Info --\x3e\n            <div>\n              <div class="nav nav-divider">\n                <h6 class="nav-item card-title mb-0">\n                  <a href="#!"> ${e.user.name} </a>\n                </h6>\n                <span class="nav-item small ps-1 ps-sm-2 time-posted">\n                  ${getTimePosted(e.createdAt)}\n                </span>\n              </div>\n              <p class="mb-0 small updated-time">\n                ${getTimeInString(e.createdAt)}\n              </p>\n            </div>\n          </div>\n          \x3c!-- Card feed action dropdown START --\x3e\n          ${a.user&&`<div class="dropdown">\n            <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2" id="cardFeedAction-${e._id}" data-bs-toggle="dropdown" aria-expanded="false">\n              <i class="fa fa-ellipsis-h text-muted"></i>\n            </a>\n            \x3c!-- Card feed action dropdown menu --\x3e\n            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="cardFeedAction-${e._id}">\n              ${a.user.id==e.user.id?`<li>\n                <a class="dropdown-item" href="/posts/destroy/${e._id}" id="delete-${e._id}-post">\n                  <i class="fa fa-trash fa-fw pe-2"></i>\n                  Delete post\n                </a>\n              </li>\n              <li>\n                <a class="dropdown-item" href="/posts/destroy/${e._id}">\n                  <i class="fa fa-edit fa-fw pe-2"></i>\n                  Edit post\n                </a>\n              </li>\n              <li class="d-sm-none">\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-bookmark fa-fw pe-2"></i>Save post</a>\n              </li>\n              <li class="d-sm-none">\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-copy fa-fw pe-2"></i>Copy link</a>\n              </li>`:`<li>\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-user fa-fw pe-2"></i>\n                  Unfollow\n                  <strong class="text-capitalize">\n                    ${e.user.name}\n                  </strong>\n                </a>\n              </li>\n              <li>\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-flag fa-fw pe-2"></i>\n                  Report post</a>\n              </li>`}\n            </ul>\n          </div>`} \n          \x3c!-- Card feed action dropdown END --\x3e\n        </div>\n      </div>\n      \x3c!-- Card header END --\x3e\n      \x3c!-- Card body START --\x3e\n      <div class="card-body pb-0  p-1 p-sm-3">\n        ${e.content&&`<p class="text-mutednpm">${e.content}</p>`}\n        \x3c!-- Card img --\x3e\n        <div class="card-image-container position-relative">\n          ${e.image?`<img class="card-img" src="${e.image}" alt="post image" />\n            <div class="viewfullscreen py-1 px-2 pe-3">\n            <button class="btn btn-sm btn-secondary-soft" data-bs-toggle="modal" data-bs-target="#modal-fullscreen-${e._id}">\n              <i class="fa-regular fa-eye fa-2x"></i>\n            </button>\n          </div>`:""}\n          ${e.video?`<video class="card-img" controls disablePictureInPicture controlsList="nodownload">\n            <source src="${e.video}" type="video/mp4" />\n          </video>`:""} \n\n          \x3c!-- Modal to view fullscreen --\x3e\n          <div class="modal fade" id="modal-fullscreen-${e._id}" tabindex="-1" aria-labelledby="modal-fullscreenLabel" aria-hidden="true">\n            <div class="modal-dialog modal-dialog-centered">\n              <div class=" modal-content">\n                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">\n\n                </button>\n\n                 ${e.image?`<img class="img-fluid rounded" src="${e.image}" alt="post image" />`:""}\n                  ${e.video?`<video class="card-img" controls disablePictureInPicture controlsList="nodownload">\n                        <source src="${e.video}" type="video/mp4" />\n                    </video>`:""}\n              </div>\n            </div>\n          </div>\n\n        </div>\n        \x3c!-- Feed react START --\x3e\n        <ul class="nav nav-stack pt-2 pb-0 small">\n          ${a.user?`<li class="nav-item">\n            <a class="nav-link toggle-like-button" data-likes="${e.likes.length}" href="/likes/toggle/?id=${e._id}&type=Post">\n              ${e.likes.find((e=>e.user._id.toString()==a.user._id.toString()))?`<span class="liked"><i class="fa fa-thumbs-up pe-1"></i>Liked (${e.likes.length})</span>`:`<span><i class="fa fa-thumbs-up pe-1"></i>Like (${e.likes.length})</span>`} \n            </a>\n          </li>\n          <li class="nav-item fw-bold">\n            <a class="nav-link" href="#!">\n              <i class="fa fa-comment pe-1"></i> Comment (${e.comments.length})\n            </a>\n          </li>\n          \x3c!-- Card share action START  --\x3e\n          <li class="nav-item dropdown ms-sm-auto fw-bold d-none d-sm-block">\n            <a class="nav-link mb-0" href="#" id="cardShareAction1-${e._id}" data-bs-toggle="dropdown" aria-expanded="false">\n              <i class="fa fa-share pe-1"></i>Share\n            </a>\n            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="cardShareAction1-${e._id}">\n              <li>\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-bookmark fa-fw pe-2"></i>Save post</a>\n              </li>\n              <li>\n                <a class="dropdown-item" href="#">\n                  <i class="fa fa-copy fa-fw pe-2"></i>Copy link</a>\n              </li>\n            </ul>\n          </li>`:`<li class="nav-item">\n            <div class="nav-link" href="/">\n              <i class="fa fa-thumbs-up pe-1"></i> Likes (${e.likes.length}\n              )\n            </div>\n          </li>\n          <li class="nav-item">\n            <div class="nav-link">\n              <i class="fa fa-comment pe-1"></i> Comment (${e.comments.length})\n            </div>\n          </li>`}\n\n        </ul>\n        <hr>\n\n        \x3c!-- Feed react END --\x3e\n        ${a.user?`<div class="d-flex mb-3">\n          \x3c!-- Add comment --\x3e\n          \x3c!-- Avatar --\x3e\n          <div class="avatar avatar-xs me-2">\n            <a href="#!">\n              <img class="avatar-img rounded-circle" src="${a.user.avatar}" alt="avatar" />\n            </a>\n          </div>\n          \x3c!-- Comment box  --\x3e\n          <form class="nav nav-item w-100 position-relative" action="/comments/create" method="POST" id="post-${e._id}-comments-form">\n            <input type="text" name="content" id="comment-input-${e._id}" class="form-control rounded-pill bg-transparent border-0 comment-input" placeholder="Write a comment" />\n            <input type="hidden" name="post" value="${e._id}" />\n            <button class="nav-link bg-transparent px-3 position-absolute top-50 end-0 translate-middle-y border-0" type="submit" id="add-comment-${e._id}">\n              <i class="fa fa-paper-plane"></i>\n            </button>\n          </form>\n        </div>`:""}\n\n        \x3c!-- Comment wrap START --\x3e\n       \n          <ul class="pt-1 pb-0 m-0 list-unstyled">\n            <div id="${e._id}-first-comment">\n            ${1==e.comments.length?n(e.comments[0],e,a):""}\n            </div>\n            <div class="collapse" id="${e._id}-comments-all">\n            \n              ${e.comments.length>1?forEach(e.comments.slice(1),(function(t){return n(t,e,a)})):""}\n            </div>\n          </ul>\n       \n        \x3c!-- Comment wrap END --\x3e\n      </div>\n      \x3c!-- Card body END --\x3e\n        ${e.comments.length>1?`\n          <div class="card-footer card-footer-${e._id}">\n            <p class="mb-0">\n              <a class="text-secondary small me-3 fw-bold text-decoration-none" data-bs-toggle="collapse" href="#${e._id}-comments-all" role="button" aria-expanded="false" aria-controls="collapseExample">Load More Comments (${e.comments.length-1})</a>\n            </p>\n          </div>\n      `:` \n        <div class="card-footer d-none card-footer-${e._id}">\n          <p class="mb-0">\n            <a class="text-secondary small me-3 fw-bold text-decoration-none" data-bs-toggle="collapse" href="#${e._id}-comments-all" role="button" aria-expanded="false" aria-controls="collapseExample">Load More Comments (${e.comments.length-1})</a>\n          </p>\n        </div>`}\n    </div>\n  </div>\n</div>`)},n=function(e,n,t){return`\n      \x3c!-- Comment item START --\x3e\n      <li class="comment-item mb-3" id="comment-${e._id}">\n        <div class="d-flex ithcomment">\n          \x3c!-- Avatar --\x3e\n          <div class="avatar avatar-xs">\n            <a href="#!">\n              <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="${e.user.name}" />\n            </a>\n          </div>\n          \x3c!-- Comment by --\x3e\n          <div class="ms-2 w-100">\n            <div class="bg-light p-3 rounded">\n              <div class="d-flex flex-column">\n                <div class="d-flex align-items-center w-100">\n                  <h6 class="mb-1 card-title d-flex flex-wrap gap-1 align-items-center justify-content-between flex-grow-1">\n                    <a href="#!"> ${e.user.name} </a>\n                    <div class="text-muted  small ps-0  time-posted">\n                      ${getTimePosted(e.createdAt)}\n                    </div>\n                  </h6>\n                  <div class="dropdown ms-1">\n                    <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2" id="commentAction" data-bs-toggle="dropdown" aria-expanded="false">\n                      <i class="fa fa-ellipsis-h text-muted"></i>\n                    </a>\n                    \x3c!-- Card feed action dropdown menu --\x3e\n                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="commentAction">\n                      ${t.user&&t.user.id==e.user.id?`<li>\n                        <a class="dropdown-item" href="/post/destroy/${e.id}">\n                          <i class="fa fa-edit fa-fw pe-2"></i>\n                          Edit Comment\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="/comments/destroy/${e.id}" id="delete-${e.id}-comment">\n                          <i class="fa fa-trash fa-fw pe-2"></i>\n                          Delete Comment\n                        </a>\n                      </li>`:t.user?`<li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-user fa-fw pe-2"></i>\n                          Unfollow\n                          <strong class="text-capitalize">\n                            ${e.user.name}\n                          </strong>\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-flag fa-fw pe-2"></i>\n                          Report Comment</a>\n                      </li>`:""}\n                    </ul>\n                  </div>\n                </div>\n                <p class="small mb-0"><%= comment.content %></p>\n              </div>\n            </div>\n            <div class="d-flex align-items-center mt-1 share">\n              ${t.user?`<a href="/likes/toggle/?id=${e._id}&type=Comment" class="text-secondary small me-3 toggle-like-button" data-likes="${e.likes.length}">\n                ${e.likes.find((e=>e.user._id.toString()==t.user._id.toString()))?`<span class="liked">\n                  <i class="fa fa-thumbs-up fa-fw me-1"></i> Liked (${e.likes.length})</span>`:` <span>\n                  <i class="fa fa-thumbs-up fa-fw me-1"></i> Like (${e.likes.length})</span>`}\n              </a>\n\n              <a class="text-secondary small me-2 d-flex align-items-center" data-bs-toggle="collapse" href="#${e._id}-reply" role=" button" aria-expanded="false" aria-controls="collapseExample">\n                <i class="fa fa-comment fa-fw me-1"></i>\n                Reply\n              </a>\n\n              <div>\n                <span class="ms-1 badge bg-secondary rounded-pill p-auto">\n                  <span class="d-none d-lg-inline-block">Replies</span>\n                  ${e.replies.length}\n                </span>\n              </div>`:`<div class="text-secondary fw-bold small me-3">\n                <i class="fa fa-thumbs-up fa-fw me-1"></i>\n                Likes (${e.likes.length})\n              </div>\n              <a class="text-secondary small me-3" href="/login">\n                Replies (${e.replies.length})\n              </a>`}\n            </div>\n          </div>\n        </div>\n\n        ${t.user?`\x3c!-- Add comment --\x3e\n              <div id="${e._id}-reply" class="collapse ms-5">\n                <div class="d-flex mt-2 mb-2">\n                  \x3c!-- Avatar --\x3e\n                  <div class="avatar avatar-xs me-2">\n                    <a href="#!">\n                      <img class="avatar-img rounded-circle" src="${t.user.avatar}" alt="avatar" />\n                    </a>\n                  </div>\n                  \x3c!-- Comment box  --\x3e\n                  <form class="nav nav-item w-100 position-relative" action="/comments/create-reply" method="POST" id="comment-${e._id}-reply-form">\n                    <input type="text" name="content" id="reply-input" class="form-control rounded-pill bg-transparent border-0" placeholder="Write a comment" />\n                    <input type="hidden" name="post" value="${n._id}" />\n                    <input type="hidden" name="comment" value="${e._id}" />\n                    <button class="nav-link bg-transparent px-3 position-absolute top-50 end-0 translate-middle-y border-0" type="submit" id="add-reply">\n                      <i class="fa fa-paper-plane"></i>\n                    </button>\n                  </form>\n                </div>\n              </div>`:""} \n              \x3c!-- Comment wrap START --\x3e\n              ${e.replies.length>0?`<ul class="pt-2 pb-0 list-unstyled ms-5">\n                      ${forEach(e.replies,(function(e){return a(e,t)}))}\n                  </ul>`:""} \n      </li>\n      \x3c!-- Comment item END --\x3e\n      `},a=function(e,n){return`\n      \x3c!-- Reply item START --\x3e\n      <li class="comment-item mb-2" id="reply-${e._id}">\n        <div class="d-flex ithreply">\n          \x3c!-- Avatar --\x3e\n          <div class="avatar avatar-xs">\n            <a href="#!">\n              <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="${e.user.name}" />\n            </a>\n          </div>\n          \x3c!-- Reply by --\x3e\n          <div class="ms-2 w-100">\n            <div class="bg-light pe-2 pe-sm-3 p-3 rounded">\n              <div class="d-flex flex-column">\n                <div class="d-flex align-items-center w-100 justify-content-between">\n\n                  <h6 class="mb-1 card-title d-flex flex-wrap gap-1 align-items-center justify-content-between flex-grow-1">\n                    <a href="#!"> ${e.user.name} </a>\n                    <div class="text-muted  small ps-0  time-posted">\n                      ${getTimePosted(e.createdAt)}\n                    </div>\n                  </h6>\n\n                  <div class="dropdown ms-1">\n                    <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2" id="replyAction" data-bs-toggle="dropdown" aria-expanded="false">\n                      <i class="fa fa-ellipsis-h text-muted"></i>\n                    </a>\n                    \x3c!-- Card feed action dropdown menu --\x3e\n                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="replyAction">\n                      ${n.user&&n.user.id==e.user.id?`<li>\n                        <a class="dropdown-item" href="/post/destroy-reply/${e._id}">\n                          <i class="fa fa-edit fa-fw pe-2"></i>\n                          Edit Reply\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="/comments/destroy-reply/${e._id}" id="delete-${e._id}-reply">\n                          <i class="fa fa-trash fa-fw pe-2"></i>\n                          Delete Reply\n                        </a>\n                      </li>`:n.user?`\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-user fa-fw pe-2"></i>\n                          Unfollow\n                          <strong class="text-capitalize">\n                            ${comment.user.name}\n                          </strong>\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-flag fa-fw pe-2"></i>\n                          Report Reply</a>\n                      </li> `:""} \n                    </ul>\n                  </div>\n                </div>\n                <p class="small mb-0">${e.content}</p>\n                \x3c!-- Like Button --\x3e\n              </div>\n            </div>\n            <div class="share">\n              ${n.user?`<a href="/likes/toggle/?id=${e._id}&type=CommentReply" data-likes="${e.likes.length}" class="text-muted small toggle-like-button">\n                ${e.likes.find((e=>e.user._id.toString()==n.user._id.toString()))?`<span class="liked">\n                  <i class="fa fa-thumbs-up fa-fw pe-2"></i>Liked (${e.likes.length})</span>`:`<span><i class="fa fa-thumbs-up fa-fw pe-2"></i>Like (${e.likes.length})</span>`} \n              </a>`:`<div class="text-muted small fw-bold">\n                <i class="fa fa-thumbs-up fa-fw pe-2"></i> Likes (${e.likes.length})\n              </div>`}\n            </div>\n          </div>\n        </div>\n      </li>\n      `},t=function(e,n){$(e).click((function(n){n.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){console.log(e.data),$(`#post-${e.data.post_id}`).remove(),new Noty({theme:"relax",type:"success",layout:"topRight",text:"Post deleted !!",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))};!function(){let n=$("#postnormalfeed"),a=$("#modalCreateFeed");n.on("click",(function(n){n.preventDefault();var s=$("#normalfeedpost > textarea").val();s?((new FormData).append("content",s),$.ajax({url:"/posts/create",method:"POST",data:{content:s},success:function(n){console.log(n);let s=e(n.data.post,n.data.locals,null);$("#post-list-container-div").prepend(s),a.modal("hide"),$("#normalfeedpost > textarea").val(""),t($(`#delete-${n.data.post._id}-post`,s)),new ToggleLike($(" .toggle-like-button",s)),new PostComments(n.data.post._id),new Noty({theme:"relax",type:"success",layout:"topRight",text:"Post Created !!!",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})):new Noty({theme:"relax",type:"error",layout:"topRight",text:"Please write something first !!!",timeout:1500}).show()}));let s=$("#postvideofeed"),i=$("#feedActionVideo");s.on("click",(function(n){n.preventDefault();var a=$("#videofeedpost > textarea").val(),s=$("#upload_videofile")[0].files[0];if(s)if(s||a){var l=new FormData;l.append("video",s),l.append("content",a),console.log(s,a),$.ajax({url:"/posts/create/?video=true",method:"POST",cache:!1,contentType:!1,processData:!1,data:l,success:function(n){console.log(n);let a=e(n.data.post,n.data.locals,s);$("#post-list-container-div").prepend(a),i.modal("hide"),$("#videofeedpost > textarea").val(""),$(".file_remove1").trigger("click"),t($(`#delete-${n.data.post._id}-post`,a)),new ToggleLike($(" .toggle-like-button",a)),new PostComments(n.data.post._id),new Noty({theme:"relax",type:"success",layout:"topRight",text:"Post Created !!!",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}else new Noty({theme:"relax",type:"error",layout:"topRight",text:"Please write something or select a video first !!!",timeout:1500}).show();else new Noty({theme:"relax",type:"error",layout:"topRight",text:"Choose a video or write something first !!!",timeout:1500}).show()}));let l=$("#postphotofeed"),o=$("#feedActionPhoto");l.on("click",(function(n){console.log("clicked"),n.preventDefault();var a=$("#photofeedpost > textarea").val(),s=$("#upload_file")[0].files[0];if(s)if(s||a){var i=new FormData;i.append("image",s),i.append("content",a),console.log(i),$.ajax({url:"/posts/create/?image=true",method:"POST",cache:!1,contentType:!1,processData:!1,data:i,success:function(n){console.log(n);let a=e(n.data.post,n.data.locals,s);$("#post-list-container-div").prepend(a),o.modal("hide"),$("#photofeedpost > textarea").val(""),$(".file_remove").trigger("click"),t($(`#delete-${n.data.post._id}-post`,a)),new ToggleLike($(" .toggle-like-button",a)),new PostComments(n.data.post._id),new Noty({theme:"relax",type:"success",layout:"topRight",text:"Post Created !!!",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}else new Noty({theme:"relax",type:"error",layout:"topRight",text:"Please write something or select an image first !!!",timeout:1500}).show();else new Noty({theme:"relax",type:"error",layout:"topRight",text:"Please select an image first !!!",timeout:1500}).show()}))}(),$("#post-list-container > div > .post").each((function(){let e=$(this),n=e.prop("id").split("-")[1],a=$(`#delete-${n}-post`,e);t(a,n),new PostComments(n)}))}));