$(document).ready((function(){socket.on("new_post",(function(t){let n=$("#local-user-data").attr("data-user");n=JSON.parse(n);let a={user:n},o=e(t.post,a,null);$("#post-list-container-div").prepend(o),l($(`#delete-${t.post._id}-post`,o)),new ToggleLike($(" .toggle-like-button",o)),PostComments(t.post._id)})),socket.on("delete_post",(function(e){$(`#post-${e}`).remove()})),socket.on("toggle_like",(function(e){let t=e.likes_count,n=e.url,a=$(`a[href="${n}"]`),o=a.children("span"),s=o.text().trim().split(" ")[0];o.html(`<i class="fa fa-thumbs-up pe-1"></i>${s} (${t})`),a.attr("data-likes",t)})),socket.on("new_comment",(function(e){let t=$("#local-user-data").attr("data-user");t=JSON.parse(t);let n={user:t},a=s(e.comment,e.post,n),o=$(`#${e.post._id}-first-comment`),i=$(`#${e.post._id}-comments-all`),l=($(`#post-${e.post._id}`),$(`#commentcnt-${e.post._id}`)),d=e.post._id;if(1==e.post.comments.length)o.prepend(a),new ToggleLike($(".toggle-like-button",o)),replyPostComment(d,e.comment._id);else if(e.post.comments.length>1){let t=o[0].firstElementChild;i.prepend(t),o.html(a),$(".toggle-like-button",o).each((function(){new ToggleLike($(this))})),replyPostComment(d,e.comment._id),$(`.card-footer-${d}`).removeClass("d-none"),$(`.card-footer-${d} > p > a`).html(`Load More Comments (${e.post.comments.length-1})`)}l.html(`<i class="fa fa-comment pe-1"></i> Comment (${e.post.comments.length})`)})),socket.on("delete_comment",(function(e){let t={firstCommentContainer:$(`#${e.data.postId}-first-comment`),remCommentContainer:$(`#${e.data.postId}-comments-all`),postContainer:$(`#post-${e.data.postId}`),commentcnt:$(`#commentcnt-${e.data.postId}`),postId:e.data.postId};if(1==e.data.commentlen)$(`#comment-${e.data.comment_id}`).remove();else if(2==e.data.commentlen)if(t.firstCommentContainer.find(`#comment-${e.data.comment_id}`).length>0){$(`#comment-${e.data.comment_id}`).remove();let n=t.remCommentContainer.html();t.remCommentContainer.html(""),t.firstCommentContainer.html(n);let o=t.firstCommentContainer[0].firstElementChild.id.split("-")[1];replyPostComment(t.postId,o),$(".delete-comment-btn",t.postContainer).each((function(){a($(this,t.postContainer),t)})),$(".toggle-like-button",t.firstCommentContainer).each((function(){new ToggleLike($(this))})),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`),$(`.card-footer-${e.data.postId}`).addClass("d-none")}else t.remCommentContainer.html(""),$(`.card-footer-${e.data.postId}`).addClass("d-none");else if(e.data.commentlen>2)if(t.firstCommentContainer.find(`#comment-${e.data.comment_id}`).length>0){$(`#comment-${e.data.comment_id}`).remove(),$(".delete-comment-btn",t.postContainer).each((function(){a($(this,t.postContainer),t)}));let n=t.remCommentContainer[0].firstElementChild;t.remCommentContainer[0].firstElementChild.remove(),t.firstCommentContainer.html(n),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`)}else $(`#comment-${e.data.comment_id}`).remove(),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`);t.commentcnt.html(`<i class="fa fa-comment pe-1"></i> Comment (${e.data.commentlen-1})`)})),socket.on("new_reply",(function(e){let t=$("#local-user-data").attr("data-user");t=JSON.parse(t);let n={user:t},a=$(`#comment-${e.data.commentId}-${e.data.postId}-reply-list`),s=$(`#replycnt-${e.data.commentId}`),l=i(e.data.reply,e.data.comment,n);a.prepend(l),new ToggleLike($(`#reply-${e.data.reply._id} .toggle-like-button`)),o($(`#delete-${e.data.reply._id}-reply`),{replycnt:s,replylen:e.data.replylen},e.data.commentId),s.html(` <span class="d-none d-lg-inline-block">Replies</span>\n                    ${e.data.comment.replies.length}`)})),socket.on("delete_reply",(function(e){let t=$(`#replycnt-${e.data.commentId}`);$(`#reply-${e.data.reply_id}`).remove(),t.html(' <span class="d-none d-lg-inline-block">Replies</span>\n                    '+(e.data.replylen-1))}));let e=function(e,a,o){return $(`\n        <div id="post-${e._id}" class="post">\n        <div class="ithpost">\n          <div class="card">\n            \x3c!-- Card header START --\x3e\n            <div class="card-header border-0 py-2 px-2">\n              <div class="d-flex align-items-center justify-content-between">\n                <div class="d-flex align-items-center">\n                  \x3c!-- Avatar --\x3e\n                  <div class="avatar avatar-story me-2">\n                    <a href="#!">\n                      <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="avatar" />\n                    </a>\n                  </div>\n                  \x3c!-- Info --\x3e\n                  <div>\n                    <div class="nav nav-divider">\n                      <h6 class="nav-item card-title mb-0">\n                        <a href="#!"> ${e.user.name} </a>\n                      </h6>\n                      <span class="nav-item small ps-1 ps-sm-2 time-posted">\n                        ${getTimePosted(e.createdAt)}\n                      </span>\n                    </div>\n                    <p class="mb-0 small updated-time">\n                      ${getTimeInString(e.createdAt)}\n                    </p>\n                  </div>\n                </div>\n                \x3c!-- Card feed action dropdown START --\x3e\n                ${a.user&&`<div class="dropdown">\n                  <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2" id="cardFeedAction-${e._id}" data-bs-toggle="dropdown" aria-expanded="false">\n                    <i class="fa fa-ellipsis-h text-muted"></i>\n                  </a>\n                  \x3c!-- Card feed action dropdown menu --\x3e\n                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="cardFeedAction-${e._id}">\n                    ${a.user._id==e.user._id?`<li>\n                      <a class="dropdown-item" href="/posts/destroy/${e._id}" id="delete-${e._id}-post">\n                        <i class="fa fa-trash fa-fw pe-2"></i>\n                        Delete post\n                      </a>\n                    </li>\n                    <li>\n                      <a class="dropdown-item" href="/posts/destroy/${e._id}">\n                        <i class="fa fa-edit fa-fw pe-2"></i>\n                        Edit post\n                      </a>\n                    </li>\n                    <li class="d-sm-none">\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-bookmark fa-fw pe-2"></i>Save post</a>\n                    </li>\n                    <li class="d-sm-none">\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-copy fa-fw pe-2"></i>Copy link</a>\n                    </li>`:`<li>\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-user fa-fw pe-2"></i>\n                        Unfollow\n                        <strong class="text-capitalize">\n                          ${e.user.name}\n                        </strong>\n                      </a>\n                    </li>\n                    <li>\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-flag fa-fw pe-2"></i>\n                        Report post</a>\n                    </li>`}\n                  </ul>\n                </div>`} \n                \x3c!-- Card feed action dropdown END --\x3e\n              </div>\n            </div>\n            \x3c!-- Card header END --\x3e\n            \x3c!-- Card body START --\x3e\n            <div class="card-body pb-0  p-1 p-sm-3">\n            ${e.poll?`\n            <div class="wrapperforpoll" id="wrapperforpoll-${e._id}">\n                <h5>${e.poll.question}</h5>\n                <div class="poll-area" id="poll-area-${e._id}">\n                ${a.user?`<div>\n                      ${e.poll.options.map(((n,o)=>t(e,a,n,o))).join("")}${e.poll.votedBy.includes(a.user._id)?e.poll.options.map(((t,o)=>n(a,e,!0,o))).join(""):e.poll.options.map(((t,o)=>n(a,e,!1,o))).join("")}\n                        </div>`:""}\n                </div>\n              </div>\n            `:""}\n              ${e.content?`\n              <div class="post-content mb-3">\n                <i class="fa fa-quote-left  text-muted "></i>\n              <p class="text-mutednpm d-inline">${e.content}</p>\n                  <i class="fa fa-quote-right text-muted "></i>\n              </div>`:""}\n              \x3c!-- Card img --\x3e\n              <div class="${e.audio?"card-audio-container":"card-image-container"} position-relative">\n                ${e.image?`<img class="card-img" src="${e.image}" alt="post image" />\n                  <div class="viewfullscreen py-1 px-2 pe-3">\n                  <button class="btn btn-sm btn-secondary-soft" data-bs-toggle="modal" data-bs-target="#modal-fullscreen-${e._id}">\n                    <i class="fa-regular fa-eye fa-2x"></i>\n                  </button>\n                </div>`:""}\n                ${e.video?`<video class="card-img" controls disablePictureInPicture controlsList="nodownload">\n                  <source src="${e.video}" />\n                </video>`:""} \n                ${e.audio?`<audio class="card-img" controls disablePictureInPicture controlsList="nodownload" src="${e.audio}">\n                </audio>`:""}\n\n                \x3c!-- Modal to view fullscreen --\x3e\n                <div class="modal fade" id="modal-fullscreen-${e._id}" tabindex="-1" aria-labelledby="modal-fullscreenLabel" aria-hidden="true">\n                  <div class="modal-dialog modal-dialog-centered">\n                    <div class=" modal-content">\n                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">\n\n                      </button>\n\n                      ${e.image?`<img class="img-fluid rounded" src="${e.image}" alt="post image" />`:""}\n                        ${e.video?`<video class="card-img" controls disablePictureInPicture controlsList="nodownload">\n                              <source src="${e.video}" type="video/mp4" />\n                          </video>`:""}\n                    </div>\n                  </div>\n                </div>\n\n              </div>\n              \x3c!-- Feed react START --\x3e\n              <ul class="nav nav-stack pt-2 pb-0 small">\n                ${null!=a.user?`<li class="nav-item">\n                  <a class="nav-link toggle-like-button" data-likes="${e.likes.length}" href="/likes/toggle/?id=${e._id}&type=Post">\n                    ${e.likes.find((e=>e.user._id.toString()==a.user._id.toString()))?`<span class="liked"><i class="fa fa-thumbs-up pe-1"></i>Liked (${e.likes.length})</span>`:`<span><i class="fa fa-thumbs-up pe-1"></i>Like (${e.likes.length})</span>`} \n                  </a>\n                </li>\n                <li class="nav-item fw-bold">\n                  <a class="nav-link" href="#!" id="commentcnt-${e._id}">\n                    <i class="fa fa-comment pe-1"></i> Comment (${e.comments.length})\n                  </a>\n                </li>\n                \x3c!-- Card share action START  --\x3e\n                <li class="nav-item dropdown ms-sm-auto fw-bold d-none d-sm-block">\n                  <a class="nav-link mb-0" href="#" id="cardShareAction1-${e._id}" data-bs-toggle="dropdown" aria-expanded="false">\n                    <i class="fa fa-share pe-1"></i>Share\n                  </a>\n                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="cardShareAction1-${e._id}">\n                    <li>\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-bookmark fa-fw pe-2"></i>Save post</a>\n                    </li>\n                    <li>\n                      <a class="dropdown-item" href="#">\n                        <i class="fa fa-copy fa-fw pe-2"></i>Copy link</a>\n                    </li>\n                  </ul>\n                </li>`:`<li class="nav-item">\n                  <div class="nav-link" href="/">\n                    <i class="fa fa-thumbs-up pe-1"></i> Likes (${e.likes.length}\n                    )\n                  </div>\n                </li>\n                <li class="nav-item">\n                  <div class="nav-link">\n                    <i class="fa fa-comment pe-1"></i> Comment (${e.comments.length})\n                  </div>\n                </li>`}\n\n              </ul>\n              <hr>\n\n              \x3c!-- Feed react END --\x3e\n              ${a.user?`<div class="d-flex mb-3">\n                \x3c!-- Add comment --\x3e\n                \x3c!-- Avatar --\x3e\n                <div class="avatar avatar-xs me-2">\n                  <a href="#!">\n                    <img class="avatar-img rounded-circle" src="${a.user.avatar}" alt="avatar" />\n                  </a>\n                </div>\n                \x3c!-- Comment box  --\x3e\n                <form class="nav nav-item w-100 position-relative" action="/comments/create" method="POST" id="post-${e._id}-comments-form">\n                  <input type="text" name="content" id="comment-input-${e._id}" class="form-control rounded-pill bg-transparent border-0 comment-input" placeholder="Write a comment" />\n                  <input type="hidden" name="post" value="${e._id}" />\n                  <button class="nav-link bg-transparent px-3 position-absolute top-50 end-0 translate-middle-y border-0" type="submit" id="add-comment-${e._id}">\n                    <i class="fa fa-paper-plane"></i>\n                  </button>\n                </form>\n              </div>`:""}\n\n              \x3c!-- Comment wrap START --\x3e\n            \n                <ul class="pt-1 pb-0 m-0 list-unstyled">\n                  <div id="${e._id}-first-comment">\n                  ${1==e.comments.length?getCommentDom(e.comments[0],e,a):""}\n                  </div>\n                  <div class="collapse" id="${e._id}-comments-all">\n                  \n                    ${e.comments.length>1?forEach(e.comments.slice(1),(function(t){return s(t,e,a)})):""}\n                  </div>\n                </ul>\n            \n              \x3c!-- Comment wrap END --\x3e\n            </div>\n            \x3c!-- Card body END --\x3e\n              ${e.comments.length>1?`\n                <div class="card-footer card-footer-${e._id}">\n                  <p class="mb-0">\n                    <a class="text-secondary small me-3 fw-bold text-decoration-none" data-bs-toggle="collapse" href="#${e._id}-comments-all" role="button" aria-expanded="false" aria-controls="collapseExample">Load More Comments (${e.comments.length-1})</a>\n                  </p>\n                </div>\n            `:` \n              <div class="card-footer d-none card-footer-${e._id}">\n                <p class="mb-0">\n                  <a class="text-secondary small me-3 fw-bold text-decoration-none" data-bs-toggle="collapse" href="#${e._id}-comments-all" role="button" aria-expanded="false" aria-controls="collapseExample">Load More Comments (${e.comments.length-1})</a>\n                </p>\n              </div>`}\n          </div>\n        </div>\n      </div>`)},t=function(e,t,n,a){return`<input type="checkbox" name="poll" id="opt-${a+1}" onclick="pollclick('${a+1}','${e._id}','${n._id}','${e.poll._id}','${t.user._id}')" \n        />`},n=function(e,t,n,a){return`<label for="opt-${a+1}" class="opt-${a+1} ${!0===n?"selectall "+(t.poll.options[a].votes.includes(e.user._id)?" selected":""):""} ">\n          <div class="row1">\n            <div class="column">\n              <span class="circle"></span>\n              <span class="text">${t.poll.options[a].text}</span>\n            </div>\n            <span class="percent" id="percent-${t.poll.options[a]._id}">${t.poll.options[a].percentage}%</span>\n          </div>\n          <div class="progress" id="progress-${t.poll.options[a]._id}" style='--w:${t.poll.options[a].percentage}'></div>\n        </label>`},a=function(e,t){let n=t;$(e).click((function(a){a.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href"),success:function(e){if(1==e.data.commentlen)$(`#comment-${e.data.comment_id}`).remove();else if(2==e.data.commentlen)if(n.firstCommentContainer.find(`#comment-${e.data.comment_id}`).length>0){$(`#comment-${e.data.comment_id}`).remove();let t=n.remCommentContainer.html();n.remCommentContainer.html(""),n.firstCommentContainer.html(t);let a=n.firstCommentContainer[0].firstElementChild.id.split("-")[1];replyPostComment(n.postId,a),$(".delete-comment-btn",n.postContainer).each((function(){deleteComment($(this,n.postContainer))})),$(".toggle-like-button",n.firstCommentContainer).each((function(){new ToggleLike($(this))})),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`),$(`.card-footer-${e.data.postId}`).addClass("d-none")}else n.remCommentContainer.html(""),$(`.card-footer-${e.data.postId}`).addClass("d-none");else if(e.data.commentlen>2)if(n.firstCommentContainer.find(`#comment-${e.data.comment_id}`).length>0){$(`#comment-${e.data.comment_id}`).remove(),$(".delete-comment-btn",n.postContainer).each((function(){deleteComment($(this,n.postContainer))}));let t=n.remCommentContainer[0].firstElementChild;n.remCommentContainer[0].firstElementChild.remove(),n.firstCommentContainer.html(t),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`)}else $(`#comment-${e.data.comment_id}`).remove(),$(`.card-footer-${e.data.postId} > p > a`).html(`Load More Comments (${e.data.commentlen-2})`);t.commentcnt.html(`<i class="fa fa-comment pe-1"></i> Comment (${e.data.commentlen-1})`),new Notification("Comment deleted !!!","success"),socket.emit("delete_comment",{data:{comment_id:e.data.comment_id,comment:e.data.comment,post:e.data.post,commentlen:e.data.commentlen,postId:e.data.postId}})},error:function(e){console.log(e.responseText),new Notification("Error in deleting comment !!!","danger")}})}))},o=function(e,t,n){$(e).click((function(a){a.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href")}).done((function(e){$(`#reply-${e.data.reply_id}`).remove(),t.replycnt.html(' <span class="d-none d-lg-inline-block">Replies</span>\n                    '+(e.data.replylen-1)),new Notification("Reply deleted","success"),socket.emit("delete_reply",{data:{reply_id:e.data.reply_id,replylen:e.data.replylen,commentId:n}})})).fail((function(e){new Notification("Error in deleting reply","danger"),console.log("error in completing the request",e)}))}))},s=function(e,t,n){return`\n      \x3c!-- Comment item START --\x3e\n      <li class="comment-item mb-3" id="comment-${e._id}">\n        <div class="d-flex ithcomment">\n          \x3c!-- Avatar --\x3e\n          <div class="avatar avatar-xs">\n            <a href="#!">\n              <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="${e.user.name}" />\n            </a>\n          </div>\n          \x3c!-- Comment by --\x3e\n          <div class="ms-2 w-100">\n            <div class="bg-light p-3 rounded">\n              <div class="d-flex flex-column">\n                <div class="d-flex align-items-center w-100">\n                  <h6 class="mb-1 card-title d-flex flex-wrap gap-1 align-items-center justify-content-between flex-grow-1">\n                    <a href="#!"> ${e.user.name} </a>\n                    <div class="text-muted  small ps-0  time-posted">\n                      ${getTimePosted(e.createdAt)}\n                    </div>\n                  </h6>\n                  <div class="dropdown ms-1">\n                    <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2 commentAction" id="commentAction-${e._id}" data-bs-toggle="dropdown" aria-expanded="false">\n                      <i class="fa fa-ellipsis-h text-muted"></i>\n                    </a>\n                    \x3c!-- Card feed action dropdown menu --\x3e\n                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="commentAction-${e._id}">\n                      ${n.user&&n.user._id==e.user._id?`<li>\n                        <a class="dropdown-item" href="/comments/destroy/${e._id}">\n                          <i class="fa fa-edit fa-fw pe-2"></i>\n                          Edit Comment\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item delete-comment-btn" href="/comments/destroy/${e._id}" id="delete-${e._id}-comment">\n                          <i class="fa fa-trash fa-fw pe-2"></i>\n                          Delete Comment\n                        </a>\n                      </li>`:n.user?`<li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-user fa-fw pe-2"></i>\n                          Unfollow\n                          <strong class="text-capitalize">\n                            ${e.user.name}\n                          </strong>\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-flag fa-fw pe-2"></i>\n                          Report Comment</a>\n                      </li>`:""}\n                    </ul>\n                  </div>\n                </div>\n                <p class="small mb-0">${e.content}</p>\n              </div>\n            </div>\n            <div class="d-flex align-items-center mt-1 share">\n              ${n.user?`\n                <a href="/likes/toggle/?id=${e._id}&type=Comment" class="text-secondary small me-3 toggle-like-button" data-likes="${e.likes.length}">\n                    ${e.likes.find((e=>e.user._id.toString()==n.user._id.toString()))?`<span class="liked">\n                            <i class="fa fa-thumbs-up fa-fw me-1"></i>Liked (${e.likes.length})\n                          </span>`:` <span>\n                              <i class="fa fa-thumbs-up fa-fw me-1"></i>Like (${e.likes.length})\n                            </span>`}\n                </a>\n                <a class="text-secondary small me-2 d-flex align-items-center" data-bs-toggle="collapse" href="#${e._id}-reply" role=" button" aria-expanded="false" aria-controls="collapseExample">\n                  <i class="fa fa-comment fa-fw me-1"></i>\n                  Reply\n                </a>\n                <div>\n                  <span class="ms-1 badge bg-secondary rounded-pill p-auto" id="replycnt-${e._id}">\n                    <span class="d-none d-lg-inline-block">Replies</span>\n                    ${e.replies.length}\n                  </span>\n                </div>`:`<div class="text-secondary fw-bold small me-3">\n                      <i class="fa fa-thumbs-up fa-fw me-1"></i>Likes (${e.likes.length})\n                    </div>\n                    <a class="text-secondary small me-3" href="/login">Replies (${e.replies.length})\n                    </a>`}\n            </div>\n          </div>\n        </div>\n\n        ${n.user?`\x3c!-- Add comment --\x3e\n              <div id="${e._id}-reply" class="collapse ms-5">\n                <div class="d-flex mt-2 mb-2">\n                  \x3c!-- Avatar --\x3e\n                  <div class="avatar avatar-xs me-2">\n                    <a href="#!">\n                      <img class="avatar-img rounded-circle" src="${n.user.avatar}" alt="avatar" />\n                    </a>\n                  </div>\n                  \x3c!-- Comment box  --\x3e\n                  <form class="nav nav-item w-100 position-relative" action="/comments/create-reply" method="POST" id="comment-${e._id}-${t._id}-reply-form">\n                    <input type="text" name="content" id="reply-input-${e._id}"\n                    class="form-control rounded-pill bg-transparent border-0 reply-input" placeholder="Write a comment " />\n                    <input type="hidden" name="post" value="${t._id}" />\n                    <input type="hidden" name="comment" value="${e._id}" />\n                    <button class="nav-link bg-transparent px-3 position-absolute top-50 end-0 translate-middle-y border-0 add-reply" type="submit" id="add-reply-${e._id}">\n                      <i class="fa fa-paper-plane"></i>\n                    </button>\n                  </form>\n                </div>\n              </div>`:""} \n        <ul class="pt-2 pb-0 list-unstyled ms-5" id="comment-${e._id}-${t._id}-reply-list">\n          \n        </ul>\n      </li>\n      \x3c!-- Comment item END --\x3e\n      `},i=function(e,t,n){return`\n      \x3c!-- Reply item START --\x3e\n      <li class="reply-item mb-2" id="reply-${e._id}">\n        <div class="d-flex ithreply">\n          \x3c!-- Avatar --\x3e\n          <div class="avatar avatar-xs">\n            <a href="#!">\n              <img class="avatar-img rounded-circle" src="${e.user.avatar?e.user.avatar:assetPath("images/default-avatar.png")}" alt="${e.user.name}" />\n            </a>\n          </div>\n          \x3c!-- Reply by --\x3e\n          <div class="ms-2 w-100">\n            <div class="bg-light pe-2 pe-sm-3 p-3 rounded">\n              <div class="d-flex flex-column">\n                <div class="d-flex align-items-center w-100 justify-content-between">\n\n                  <h6 class="mb-1 card-title d-flex flex-wrap gap-1 align-items-center justify-content-between flex-grow-1">\n                    <a href="#!"> ${e.user.name} </a>\n                    <div class="text-muted  small ps-0  time-posted">\n                      ${getTimePosted(e.createdAt)}\n                    </div>\n                  </h6>\n\n                  <div class="dropdown ms-1">\n                    <a href="#" class="text-secondary btn btn-secondary-soft-hover py-1 px-2" id="replyAction" data-bs-toggle="dropdown" aria-expanded="false">\n                      <i class="fa fa-ellipsis-h text-muted"></i>\n                    </a>\n                    \x3c!-- Card feed action dropdown menu --\x3e\n                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="replyAction">\n                      ${n.user&&n.user._id==e.user._id?`<li>\n                        <a class="dropdown-item" href="/post/destroy-reply/${e._id}">\n                          <i class="fa fa-edit fa-fw pe-2"></i>\n                          Edit Reply\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item delete-reply-btn" href="/comments/destroy-reply/${e._id}" id="delete-${e._id}-reply">\n                          <i class="fa fa-trash fa-fw pe-2"></i>\n                          Delete Reply\n                        </a>\n                      </li>`:n.user?`\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-user fa-fw pe-2"></i>\n                          Unfollow\n                          <strong class="text-capitalize">\n                            ${e.user.name}\n                          </strong>\n                        </a>\n                      </li>\n                      <li>\n                        <a class="dropdown-item" href="#">\n                          <i class="fa fa-flag fa-fw pe-2"></i>\n                          Report Reply</a>\n                      </li> `:""} \n                    </ul>\n                  </div>\n                </div>\n                <p class="small mb-0">${e.content}</p>\n                \x3c!-- Like Button --\x3e\n              </div>\n            </div>\n            <div class="share">\n              ${n.user?`<a href="/likes/toggle/?id=${e._id}&type=CommentReply" data-likes="${e.likes.length}" class="text-muted small toggle-like-button">\n                ${e.likes.find((e=>e.user._id.toString()==n.user._id.toString()))?`\n                      <span class="liked">\n                        <i class="fa fa-thumbs-up fa-fw pe-2"></i>Liked (${e.likes.length})\n                      </span>`:`<span><i class="fa fa-thumbs-up fa-fw pe-2"></i>Like (${e.likes.length})</span>`} \n              </a>`:`<div class="text-muted small fw-bold">\n                <i class="fa fa-thumbs-up fa-fw pe-2"></i>Likes (${e.likes.length})\n              </div>`}\n            </div>\n          </div>\n        </div>\n      </li>\n      `},l=function(e,t){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#post-${e.data.post_id}`).remove(),new Notification("Post Deleted !!!","success"),socket.emit("delete_post",e.data.post_id)},error:function(e){console.log(e.responseText)}})}))};!function(){let t=$("#postnormalfeed"),n=$("#modalCreateFeed");t.on("click",(function(a){a.preventDefault();var o=$("#normalfeedpost > textarea").val();o?((new FormData).append("content",o),t.attr("disabled",!0),$(".lds-ellipsis").removeClass("d-none"),$.ajax({url:"/posts/create",method:"POST",data:{content:o}}).done((function(a){let o=e(a.data.post,a.data.locals,null);$("#post-list-container-div").prepend(o),n.modal("hide"),$("#normalfeedpost > textarea").val(""),l($(`#delete-${a.data.post._id}-post`,o)),new ToggleLike($(" .toggle-like-button",o)),PostComments(a.data.post._id),new Notification("Post Created !!!","success"),socket.emit("new_post",{post:a.data.post,type:"normal"}),t.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")})).fail((function(e){console.log(e.responseText),new Notification("Error in creating post !!!","error"),t.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")}))):new Notification("Please write something first !!!","warning")}));let a=$("#postvideofeed"),o=$("#feedActionVideo");a.on("click",(function(t){t.preventDefault();var n=$("#videofeedpost > textarea").val(),s=$("#upload_videofile")[0].files[0];if(s||n)if(s){a.attr("disabled",!0),$(".lds-ellipsis").removeClass("d-none");var i=new FormData;i.append("video",s),i.append("content",n),$.ajax({url:"/posts/create/?video=true",method:"POST",cache:!1,contentType:!1,processData:!1,data:i}).done((function(t){let n=e(t.data.post,t.data.locals,s);$("#post-list-container-div").prepend(n),o.modal("hide"),$("#videofeedpost > textarea").val(""),$(".file_remove1").trigger("click"),l($(`#delete-${t.data.post._id}-post`,n)),new ToggleLike($(" .toggle-like-button",n)),PostComments(t.data.post._id),new Notification("Post Created !!!","success"),socket.emit("new_post",{post:t.data.post,type:"video"}),a.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")})).fail((function(e){console.log(e.responseText),new Notification("Error in creating post !!!","error"),a.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")}))}else new Notification("Please select a video first !!!","warning");else new Notification("Please write something or select a video first !!!","warning")}));let s=$("#postphotofeed"),i=$("#feedActionPhoto");s.on("click",(function(t){t.preventDefault();var n=$("#photofeedpost > textarea").val(),a=$("#upload_file")[0].files[0];if(a||n)if(a){s.attr("disabled",!0),$(".lds-ellipsis").removeClass("d-none");var o=new FormData;o.append("image",a),o.append("content",n),$.ajax({url:"/posts/create/?image=true",method:"POST",cache:!1,contentType:!1,processData:!1,data:o}).done((function(t){let n=e(t.data.post,t.data.locals,a);$("#post-list-container-div").prepend(n),i.modal("hide"),$("#photofeedpost > textarea").val(""),$(".file_remove").trigger("click"),l($(`#delete-${t.data.post._id}-post`,n)),new ToggleLike($(" .toggle-like-button",n)),PostComments(t.data.post._id),new Notification("Post Created !!!","success"),socket.emit("new_post",{post:t.data.post,type:"image"}),s.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")})).fail((function(e){console.log(e.responseText),new Notification("Error in creating post !!!","error"),s.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")}))}else new Notification("Please select an image first !!!","warning");else new Notification("Please write something or select an image first !!!","warning")}));let d=$("#postaudiofeed"),r=$("#feedActionAudio");d.on("click",(function(t){t.preventDefault();var n=$("#audiofeedpost > textarea").val(),a=$("#upload_audiofile")[0].files[0];if(a||n)if(a){d.attr("disabled",!0),$(".lds-ellipsis").removeClass("d-none");var o=new FormData;o.append("audio",a),o.append("content",n),$.ajax({url:"/posts/create/?audio=true",method:"POST",cache:!1,contentType:!1,processData:!1,data:o}).done((function(t){let n=e(t.data.post,t.data.locals,a);$("#post-list-container-div").prepend(n),r.modal("hide"),$("#audiofeedpost > textarea").val(""),$(".file_remove2").trigger("click"),l($(`#delete-${t.data.post._id}-post`,n)),new ToggleLike($(" .toggle-like-button",n)),PostComments(t.data.post._id),new Notification("Post Created !!!","success"),socket.emit("new_post",{post:t.data.post,type:"audio"}),d.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")})).fail((function(e){console.log(e.responseText),new Notification("Error in creating post !!!","error"),d.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")}))}else new Notification("Please select a audio first !!!","warning");else new Notification("Please write something or select a audio first !!!","warning")}));let c=$("#postpollfeed"),m=$("#feedActionPoll");c.on("click",(function(t){t.preventDefault();var n=$("#pollfeedpost").serialize();c.attr("disabled",!0),$(".lds-ellipsis").removeClass("d-none"),$.ajax({url:"/posts/create/?poll=true",method:"POST",data:n}).done((function(t){let n=e(t.data.post,t.data.locals,null);$("#post-list-container-div").prepend(n),m.modal("hide"),l($(`#delete-${t.data.post._id}-post`,n)),new ToggleLike($(" .toggle-like-button",n)),PostComments(t.data.post._id),new Notification("Post Created !!!","success"),socket.emit("new_post",{post:t.data.post,type:"poll"}),c.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")})).fail((function(e){console.log(e.responseText),new Notification("Error in creating post !!!","error"),c.attr("disabled",!1),$(".lds-ellipsis").addClass("d-none")}))}))}(),$("#post-list-container > div > .post").each((function(){let e=$(this),t=e.prop("id").split("-")[1],n=$(`#delete-${t}-post`,e);l(n,t),PostComments(t)}))}));